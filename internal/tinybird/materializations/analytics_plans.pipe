NODE analytics_plans_mv_node
DESCRIPTION >
    Materialized view that aggregates plan_click events

SQL >
    SELECT
        toDate(timestamp) AS date,
        session_id,
        plan_version_id,
        plan_slug,
        plan_version,
        page_id,
        uniqState(session_id) AS unique_clicks,
        countState() AS total_clicks
    FROM plan_clicks
    GROUP BY date, session_id, plan_version_id, plan_slug, plan_version, page_id

TYPE MATERIALIZED
DATASOURCE analytics_plans_mv
